/**
 * Angular wrapper for Bryntum ProjectModel
 */
import { Component, EventEmitter, Output, Input } from '@angular/core';
import WrapperHelper from './wrapper.helper';
import { ProjectModel, WidgetHelper } from '@bryntum/calendar';
import * as i0 from "@angular/core";
export class BryntumProjectModelComponent {
    constructor(element) {
        this.bryntumConfig = {
            adopt: undefined,
            appendTo: undefined,
            href: undefined,
            angularComponent: this,
            features: {},
            listeners: {}
        };
        // Events
        this.onChange = new EventEmitter();
        this.onDataReady = new EventEmitter();
        this.elementRef = element;
    }
    /**
     * Create and append the underlying widget
     */
    ngOnInit() {
        const me = this, { elementRef, bryntumConfig } = me, { instanceClass, instanceName, bryntumConfigs, bryntumEvents } = BryntumProjectModelComponent;
        bryntumConfigs.filter(prop => prop in this).forEach(prop => {
            // @ts-ignore
            WrapperHelper.applyPropValue(bryntumConfig, prop, this[prop]);
            if (['features', 'config'].includes(prop)) {
                WrapperHelper.devWarningConfigProp(instanceName, prop);
            }
        });
        // @ts-ignore
        bryntumEvents.filter(event => this[event] && this[event].observers.length > 0).forEach(event => {
            const uncapitalize = (str) => str.charAt(0).toLowerCase() + str.slice(1), eventName = (str) => uncapitalize(str.slice(2));
            // @ts-ignore
            bryntumConfig.listeners[eventName(event)] = e => {
                // @ts-ignore
                me[event].emit(e);
                // EventEmitter does not return values in the normal way, work around it by setting `returnValue` flag
                // in Angular listeners
                return e.returnValue;
            };
        });
        // If component has no container specified in config then use adopt to Wrapper's element
        const containerParam = [
            'adopt',
            'appendTo',
            'insertAfter',
            'insertBefore'
            // @ts-ignore
        ].find(prop => bryntumConfig[prop]);
        if (!containerParam) {
            if (instanceName === 'Button') {
                // Button should always be <a> or <button> inside owner element
                bryntumConfig.appendTo = elementRef.nativeElement;
            }
            else {
                bryntumConfig.adopt = elementRef.nativeElement;
            }
        }
        else {
            WrapperHelper.devWarningContainer(instanceName, containerParam);
        }
        // @ts-ignore
        me.instance = instanceName === 'Widget' ? WidgetHelper.createWidget(bryntumConfig) : new instanceClass(bryntumConfig);
    }
    /**
     * Watch for changes
     * @param changes
     */
    ngOnChanges(changes) {
        const { instance } = this, { instanceName } = BryntumProjectModelComponent;
        if (!instance) {
            return;
        }
        // Iterate over all changes
        Object.entries(changes).forEach(([prop, change]) => {
            const newValue = change.currentValue, { instance } = this, { bryntumConfigsOnly, bryntumProps } = BryntumProjectModelComponent;
            if (bryntumProps.includes(prop)) {
                WrapperHelper.applyPropValue(instance, prop, newValue, false);
                if (bryntumConfigsOnly.includes(prop)) {
                    WrapperHelper.devWarningUpdateProp(instanceName, prop);
                }
            }
        });
    }
    /**
     * Destroy the component
     */
    ngOnDestroy() {
        // @ts-ignore
        this.instance && this.instance.destroy && this.instance.destroy();
    }
}
BryntumProjectModelComponent.instanceClass = ProjectModel;
BryntumProjectModelComponent.instanceName = 'ProjectModel';
BryntumProjectModelComponent.bryntumEvents = [
    'onChange',
    'onDataReady'
];
BryntumProjectModelComponent.bryntumFeatureNames = [];
BryntumProjectModelComponent.bryntumConfigs = BryntumProjectModelComponent.bryntumFeatureNames.concat([
    'assignmentModelClass',
    'assignments',
    'assignmentsData',
    'assignmentStore',
    'assignmentStoreClass',
    'children',
    'dependencies',
    'dependenciesData',
    'dependencyModelClass',
    'dependencyStore',
    'dependencyStoreClass',
    'eventModelClass',
    'events',
    'eventsData',
    'eventStore',
    'eventStoreClass',
    'expanded',
    'id',
    'json',
    'orderedParentIndex',
    'parentId',
    'parentIndex',
    'readOnly',
    'resourceModelClass',
    'resources',
    'resourcesData',
    'resourceStore',
    'resourceStoreClass',
    'resourceTimeRanges',
    'resourceTimeRangesData',
    'resourceTimeRangeStore',
    'resourceTimeRangeStoreClass',
    'silenceInitialCommit',
    'stm',
    'timeRangeModelClass',
    'timeRanges',
    'timeRangesData',
    'timeRangeStore',
    'timeRangeStoreClass',
    'timeZone'
]);
BryntumProjectModelComponent.bryntumConfigsOnly = [
    'assignmentModelClass',
    'assignmentsData',
    'assignmentStoreClass',
    'dependenciesData',
    'dependencyModelClass',
    'dependencyStoreClass',
    'eventModelClass',
    'eventsData',
    'eventStoreClass',
    'expanded',
    'orderedParentIndex',
    'parentId',
    'parentIndex',
    'resourceModelClass',
    'resourcesData',
    'resourceStoreClass',
    'resourceTimeRangesData',
    'resourceTimeRangeStoreClass',
    'silenceInitialCommit',
    'timeRangeModelClass',
    'timeRangesData',
    'timeRangeStoreClass'
];
BryntumProjectModelComponent.bryntumProps = BryntumProjectModelComponent.bryntumFeatureNames.concat([
    'allChildren',
    'assignments',
    'assignmentStore',
    'autoExposeFields',
    'children',
    'childrenField',
    'convertEmptyParentToLeaf',
    'defaults',
    'dependencies',
    'dependencyStore',
    'descendantCount',
    'events',
    'eventStore',
    'hasGeneratedId',
    'id',
    'idField',
    'inlineData',
    'internalId',
    'isCommitting',
    'isCreating',
    'isValid',
    'json',
    'previousSiblingsTotalCount',
    'readOnly',
    'relations',
    'resources',
    'resourceStore',
    'resourceTimeRanges',
    'resourceTimeRangeStore',
    'stm',
    'timeRanges',
    'timeRangeStore',
    'timeZone',
    'visibleDescendantCount'
]);
BryntumProjectModelComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.0", ngImport: i0, type: BryntumProjectModelComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component });
BryntumProjectModelComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.0", type: BryntumProjectModelComponent, selector: "bryntum-project-model", inputs: { assignmentModelClass: "assignmentModelClass", assignmentsData: "assignmentsData", assignmentStoreClass: "assignmentStoreClass", dependenciesData: "dependenciesData", dependencyModelClass: "dependencyModelClass", dependencyStoreClass: "dependencyStoreClass", eventModelClass: "eventModelClass", eventsData: "eventsData", eventStoreClass: "eventStoreClass", expanded: "expanded", orderedParentIndex: "orderedParentIndex", parentId: "parentId", parentIndex: "parentIndex", resourceModelClass: "resourceModelClass", resourcesData: "resourcesData", resourceStoreClass: "resourceStoreClass", resourceTimeRangesData: "resourceTimeRangesData", resourceTimeRangeStoreClass: "resourceTimeRangeStoreClass", silenceInitialCommit: "silenceInitialCommit", timeRangeModelClass: "timeRangeModelClass", timeRangesData: "timeRangesData", timeRangeStoreClass: "timeRangeStoreClass", assignments: "assignments", assignmentStore: "assignmentStore", children: "children", dependencies: "dependencies", dependencyStore: "dependencyStore", events: "events", eventStore: "eventStore", id: "id", json: "json", readOnly: "readOnly", resources: "resources", resourceStore: "resourceStore", resourceTimeRanges: "resourceTimeRanges", resourceTimeRangeStore: "resourceTimeRangeStore", stm: "stm", timeRanges: "timeRanges", timeRangeStore: "timeRangeStore", timeZone: "timeZone", allChildren: "allChildren", autoExposeFields: "autoExposeFields", childrenField: "childrenField", convertEmptyParentToLeaf: "convertEmptyParentToLeaf", defaults: "defaults", descendantCount: "descendantCount", hasGeneratedId: "hasGeneratedId", idField: "idField", inlineData: "inlineData", internalId: "internalId", isCommitting: "isCommitting", isCreating: "isCreating", isValid: "isValid", previousSiblingsTotalCount: "previousSiblingsTotalCount", relations: "relations", visibleDescendantCount: "visibleDescendantCount" }, outputs: { onChange: "onChange", onDataReady: "onDataReady" }, usesOnChanges: true, ngImport: i0, template: '', isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.0", ngImport: i0, type: BryntumProjectModelComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bryntum-project-model',
                    template: ''
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { assignmentModelClass: [{
                type: Input
            }], assignmentsData: [{
                type: Input
            }], assignmentStoreClass: [{
                type: Input
            }], dependenciesData: [{
                type: Input
            }], dependencyModelClass: [{
                type: Input
            }], dependencyStoreClass: [{
                type: Input
            }], eventModelClass: [{
                type: Input
            }], eventsData: [{
                type: Input
            }], eventStoreClass: [{
                type: Input
            }], expanded: [{
                type: Input
            }], orderedParentIndex: [{
                type: Input
            }], parentId: [{
                type: Input
            }], parentIndex: [{
                type: Input
            }], resourceModelClass: [{
                type: Input
            }], resourcesData: [{
                type: Input
            }], resourceStoreClass: [{
                type: Input
            }], resourceTimeRangesData: [{
                type: Input
            }], resourceTimeRangeStoreClass: [{
                type: Input
            }], silenceInitialCommit: [{
                type: Input
            }], timeRangeModelClass: [{
                type: Input
            }], timeRangesData: [{
                type: Input
            }], timeRangeStoreClass: [{
                type: Input
            }], assignments: [{
                type: Input
            }], assignmentStore: [{
                type: Input
            }], children: [{
                type: Input
            }], dependencies: [{
                type: Input
            }], dependencyStore: [{
                type: Input
            }], events: [{
                type: Input
            }], eventStore: [{
                type: Input
            }], id: [{
                type: Input
            }], json: [{
                type: Input
            }], readOnly: [{
                type: Input
            }], resources: [{
                type: Input
            }], resourceStore: [{
                type: Input
            }], resourceTimeRanges: [{
                type: Input
            }], resourceTimeRangeStore: [{
                type: Input
            }], stm: [{
                type: Input
            }], timeRanges: [{
                type: Input
            }], timeRangeStore: [{
                type: Input
            }], timeZone: [{
                type: Input
            }], allChildren: [{
                type: Input
            }], autoExposeFields: [{
                type: Input
            }], childrenField: [{
                type: Input
            }], convertEmptyParentToLeaf: [{
                type: Input
            }], defaults: [{
                type: Input
            }], descendantCount: [{
                type: Input
            }], hasGeneratedId: [{
                type: Input
            }], idField: [{
                type: Input
            }], inlineData: [{
                type: Input
            }], internalId: [{
                type: Input
            }], isCommitting: [{
                type: Input
            }], isCreating: [{
                type: Input
            }], isValid: [{
                type: Input
            }], previousSiblingsTotalCount: [{
                type: Input
            }], relations: [{
                type: Input
            }], visibleDescendantCount: [{
                type: Input
            }], onChange: [{
                type: Output
            }], onDataReady: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJ5bnR1bS1wcm9qZWN0LW1vZGVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvbXBvbmVudC9zcmMvbGliL2JyeW50dW0tcHJvamVjdC1tb2RlbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFFSCxPQUFPLEVBQUUsU0FBUyxFQUFjLFlBQVksRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFrRCxNQUFNLGVBQWUsQ0FBQztBQUVuSSxPQUFPLGFBQWEsTUFBTSxrQkFBa0IsQ0FBQztBQUc3QyxPQUFPLEVBQUUsWUFBWSxFQUFnQixZQUFZLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQzs7QUFNN0UsTUFBTSxPQUFPLDRCQUE0QjtJQW9JckMsWUFBWSxPQUFtQjtRQVR2QixrQkFBYSxHQUFHO1lBQ3BCLEtBQUssRUFBYyxTQUFTO1lBQzVCLFFBQVEsRUFBVyxTQUFTO1lBQzVCLElBQUksRUFBZSxTQUFTO1lBQzVCLGdCQUFnQixFQUFHLElBQUk7WUFDdkIsUUFBUSxFQUFXLEVBQUU7WUFDckIsU0FBUyxFQUFVLEVBQUU7U0FDeEIsQ0FBQztRQW9FRCxTQUFTO1FBQ0EsYUFBUSxHQUFNLElBQUksWUFBWSxFQUFVLENBQUM7UUFDekMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBbkUvQyxJQUFJLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQztJQUM5QixDQUFDO0lBb0VEOztPQUVHO0lBQ0gsUUFBUTtRQUNKLE1BQ0ksRUFBRSxHQUFHLElBQUksRUFDVCxFQUNJLFVBQVUsRUFDVixhQUFhLEVBQ2hCLEdBQUcsRUFBRSxFQUNOLEVBQ0ksYUFBYSxFQUNiLFlBQVksRUFDWixjQUFjLEVBQ2QsYUFBYSxFQUNoQixHQUFHLDRCQUE0QixDQUFDO1FBRXJDLGNBQWMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLENBQUMs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c0JBQWpCLEtBQUs7Z0JBQ0csYUFBYTtzQkFBckIsS0FBSztnQkFDRyxrQkFBa0I7c0JBQTFCLEtBQUs7Z0JBQ0csc0JBQXNCO3NCQUE5QixLQUFLO2dCQUNHLEdBQUc7c0JBQVgsS0FBSztnQkFDRyxVQUFVO3NCQUFsQixLQUFLO2dCQUNHLGNBQWM7c0JBQXRCLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFHRyxXQUFXO3NCQUFuQixLQUFLO2dCQUNHLGdCQUFnQjtzQkFBeEIsS0FBSztnQkFDRyxhQUFhO3NCQUFyQixLQUFLO2dCQUNHLHdCQUF3QjtzQkFBaEMsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLGVBQWU7c0JBQXZCLEtBQUs7Z0JBQ0csY0FBYztzQkFBdEIsS0FBSztnQkFDRyxPQUFPO3NCQUFmLEtBQUs7Z0JBQ0csVUFBVTtzQkFBbEIsS0FBSztnQkFDRyxVQUFVO3NCQUFsQixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csVUFBVTtzQkFBbEIsS0FBSztnQkFDRyxPQUFPO3NCQUFmLEtBQUs7Z0JBQ0csMEJBQTBCO3NCQUFsQyxLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csc0JBQXNCO3NCQUE5QixLQUFLO2dCQUdJLFFBQVE7c0JBQWpCLE1BQU07Z0JBQ0csV0FBVztzQkFBcEIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQW5ndWxhciB3cmFwcGVyIGZvciBCcnludHVtIFByb2plY3RNb2RlbFxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIElucHV0LCBTaW1wbGVDaGFuZ2UsIFNpbXBsZUNoYW5nZXMsIE9uRGVzdHJveSwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCBXcmFwcGVySGVscGVyIGZyb20gJy4vd3JhcHBlci5oZWxwZXInO1xuXG5pbXBvcnQgeyBBc3NpZ25tZW50TW9kZWwsIEFzc2lnbm1lbnRNb2RlbENvbmZpZywgQXNzaWdubWVudFN0b3JlLCBBc3NpZ25tZW50U3RvcmVDb25maWcsIERlcGVuZGVuY3lNb2RlbCwgRGVwZW5kZW5jeU1vZGVsQ29uZmlnLCBEZXBlbmRlbmN5U3RvcmUsIERlcGVuZGVuY3lTdG9yZUNvbmZpZywgRXZlbnRNb2RlbCwgRXZlbnRNb2RlbENvbmZpZywgRXZlbnRTdG9yZSwgRXZlbnRTdG9yZUNvbmZpZywgTW9kZWwsIE1vZGVsQ29uZmlnLCBSZWxhdGlvbkNvbmZpZywgUmVzb3VyY2VNb2RlbCwgUmVzb3VyY2VNb2RlbENvbmZpZywgUmVzb3VyY2VTdG9yZSwgUmVzb3VyY2VTdG9yZUNvbmZpZywgUmVzb3VyY2VUaW1lUmFuZ2VNb2RlbCwgUmVzb3VyY2VUaW1lUmFuZ2VNb2RlbENvbmZpZywgUmVzb3VyY2VUaW1lUmFuZ2VTdG9yZSwgUmVzb3VyY2VUaW1lUmFuZ2VTdG9yZUNvbmZpZywgU3RhdGVUcmFja2luZ01hbmFnZXIsIFN0YXRlVHJhY2tpbmdNYW5hZ2VyQ29uZmlnLCBTdG9yZSwgU3RvcmVDb25maWcsIFRpbWVSYW5nZU1vZGVsLCBUaW1lU3BhbiwgVGltZVNwYW5Db25maWcgfSBmcm9tICdAYnJ5bnR1bS9jYWxlbmRhcic7XG5pbXBvcnQgeyBQcm9qZWN0TW9kZWwsIFN0cmluZ0hlbHBlciwgV2lkZ2V0SGVscGVyIH0gZnJvbSAnQGJyeW50dW0vY2FsZW5kYXInO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvciA6ICdicnludHVtLXByb2plY3QtbW9kZWwnLFxuICAgIHRlbXBsYXRlIDogJydcbn0pXG5leHBvcnQgY2xhc3MgQnJ5bnR1bVByb2plY3RNb2RlbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcblxuICAgIHB1YmxpYyBzdGF0aWMgaW5zdGFuY2VDbGFzcyA9IFByb2plY3RNb2RlbDtcblxuICAgIHB1YmxpYyBzdGF0aWMgaW5zdGFuY2VOYW1lID0gJ1Byb2plY3RNb2RlbCc7XG5cbiAgICBwcml2YXRlIHN0YXRpYyBicnludHVtRXZlbnRzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgJ29uQ2hhbmdlJyxcbiAgICAgICAgJ29uRGF0YVJlYWR5J1xuICAgIF07XG5cbiAgICBwcml2YXRlIHN0YXRpYyBicnludHVtRmVhdHVyZU5hbWVzOiBzdHJpbmdbXSA9IFtcblxuICAgIF07XG5cbiAgICBwcml2YXRlIHN0YXRpYyBicnludHVtQ29uZmlnczogc3RyaW5nW10gPSBCcnludHVtUHJvamVjdE1vZGVsQ29tcG9uZW50LmJyeW50dW1GZWF0dXJlTmFtZXMuY29uY2F0KFtcbiAgICAgICAgJ2Fzc2lnbm1lbnRNb2RlbENsYXNzJyxcbiAgICAgICAgJ2Fzc2lnbm1lbnRzJyxcbiAgICAgICAgJ2Fzc2lnbm1lbnRzRGF0YScsXG4gICAgICAgICdhc3NpZ25tZW50U3RvcmUnLFxuICAgICAgICAnYXNzaWdubWVudFN0b3JlQ2xhc3MnLFxuICAgICAgICAnY2hpbGRyZW4nLFxuICAgICAgICAnZGVwZW5kZW5jaWVzJyxcbiAgICAgICAgJ2RlcGVuZGVuY2llc0RhdGEnLFxuICAgICAgICAnZGVwZW5kZW5jeU1vZGVsQ2xhc3MnLFxuICAgICAgICAnZGVwZW5kZW5jeVN0b3JlJyxcbiAgICAgICAgJ2RlcGVuZGVuY3lTdG9yZUNsYXNzJyxcbiAgICAgICAgJ2V2ZW50TW9kZWxDbGFzcycsXG4gICAgICAgICdldmVudHMnLFxuICAgICAgICAnZXZlbnRzRGF0YScsXG4gICAgICAgICdldmVudFN0b3JlJyxcbiAgICAgICAgJ2V2ZW50U3RvcmVDbGFzcycsXG4gICAgICAgICdleHBhbmRlZCcsXG4gICAgICAgICdpZCcsXG4gICAgICAgICdqc29uJyxcbiAgICAgICAgJ29yZGVyZWRQYXJlbnRJbmRleCcsXG4gICAgICAgICdwYXJlbnRJZCcsXG4gICAgICAgICdwYXJlbnRJbmRleCcsXG4gICAgICAgICdyZWFkT25seScsXG4gICAgICAgICdyZXNvdXJjZU1vZGVsQ2xhc3MnLFxuICAgICAgICAncmVzb3VyY2VzJyxcbiAgICAgICAgJ3Jlc291cmNlc0RhdGEnLFxuICAgICAgICAncmVzb3VyY2VTdG9yZScsXG4gICAgICAgICdyZXNvdXJjZVN0b3JlQ2xhc3MnLFxuICAgICAgICAncmVzb3VyY2VUaW1lUmFuZ2VzJyxcbiAgICAgICAgJ3Jlc291cmNlVGltZVJhbmdlc0RhdGEnLFxuICAgICAgICAncmVzb3VyY2VUaW1lUmFuZ2VTdG9yZScsXG4gICAgICAgICdyZXNvdXJjZVRpbWVSYW5nZVN0b3JlQ2xhc3MnLFxuICAgICAgICAnc2lsZW5jZUluaXRpYWxDb21taXQnLFxuICAgICAgICAnc3RtJyxcbiAgICAgICAgJ3RpbWVSYW5nZU1vZGVsQ2xhc3MnLFxuICAgICAgICAndGltZVJhbmdlcycsXG4gICAgICAgICd0aW1lUmFuZ2VzRGF0YScsXG4gICAgICAgICd0aW1lUmFuZ2VTdG9yZScsXG4gICAgICAgICd0aW1lUmFuZ2VTdG9yZUNsYXNzJyxcbiAgICAgICAgJ3RpbWVab25lJ1xuICAgIF0pO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYnJ5bnR1bUNvbmZpZ3NPbmx5OiBzdHJpbmdbXSA9IFtcbiAgICAgICAgJ2Fzc2lnbm1lbnRNb2RlbENsYXNzJyxcbiAgICAgICAgJ2Fzc2lnbm1lbnRzRGF0YScsXG4gICAgICAgICdhc3NpZ25tZW50U3RvcmVDbGFzcycsXG4gICAgICAgICdkZXBlbmRlbmNpZXNEYXRhJyxcbiAgICAgICAgJ2RlcGVuZGVuY3lNb2RlbENsYXNzJyxcbiAgICAgICAgJ2RlcGVuZGVuY3lTdG9yZUNsYXNzJyxcbiAgICAgICAgJ2V2ZW50TW9kZWxDbGFzcycsXG4gICAgICAgICdldmVudHNEYXRhJyxcbiAgICAgICAgJ2V2ZW50U3RvcmVDbGFzcycsXG4gICAgICAgICdleHBhbmRlZCcsXG4gICAgICAgICdvcmRlcmVkUGFyZW50SW5kZXgnLFxuICAgICAgICAncGFyZW50SWQnLFxuICAgICAgICAncGFyZW50SW5kZXgnLFxuICAgICAgICAncmVzb3VyY2VNb2RlbENsYXNzJyxcbiAgICAgICAgJ3Jlc291cmNlc0RhdGEnLFxuICAgICAgICAncmVzb3VyY2VTdG9yZUNsYXNzJyxcbiAgICAgICAgJ3Jlc291cmNlVGltZVJhbmdlc0RhdGEnLFxuICAgICAgICAncmVzb3VyY2VUaW1lUmFuZ2VTdG9yZUNsYXNzJyxcbiAgICAgICAgJ3NpbGVuY2VJbml0aWFsQ29tbWl0JyxcbiAgICAgICAgJ3RpbWVSYW5nZU1vZGVsQ2xhc3MnLFxuICAgICAgICAndGltZVJhbmdlc0RhdGEnLFxuICAgICAgICAndGltZVJhbmdlU3RvcmVDbGFzcydcbiAgICBdO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgYnJ5bnR1bVByb3BzOiBzdHJpbmdbXSA9IEJyeW50dW1Qcm9qZWN0TW9kZWxDb21wb25lbnQuYnJ5bnR1bUZlYXR1cmVOYW1lcy5jb25jYXQoW1xuICAgICAgICAnYWxsQ2hpbGRyZW4nLFxuICAgICAgICAnYXNzaWdubWVudHMnLFxuICAgICAgICAnYXNzaWdubWVudFN0b3JlJyxcbiAgICAgICAgJ2F1dG9FeHBvc2VGaWVsZHMnLFxuICAgICAgICAnY2hpbGRyZW4nLFxuICAgICAgICAnY2hpbGRyZW5GaWVsZCcsXG4gICAgICAgICdjb252ZXJ0RW1wdHlQYXJlbnRUb0xlYWYnLFxuICAgICAgICAnZGVmYXVsdHMnLFxuICAgICAgICAnZGVwZW5kZW5jaWVzJyxcbiAgICAgICAgJ2RlcGVuZGVuY3lTdG9yZScsXG4gICAgICAgICdkZXNjZW5kYW50Q291bnQnLFxuICAgICAgICAnZXZlbnRzJyxcbiAgICAgICAgJ2V2ZW50U3RvcmUnLFxuICAgICAgICAnaGFzR2VuZXJhdGVkSWQnLFxuICAgICAgICAnaWQnLFxuICAgICAgICAnaWRGaWVsZCcsXG4gICAgICAgICdpbmxpbmVEYXRhJyxcbiAgICAgICAgJ2ludGVybmFsSWQnLFxuICAgICAgICAnaXNDb21taXR0aW5nJyxcbiAgICAgICAgJ2lzQ3JlYXRpbmcnLFxuICAgICAgICAnaXNWYWxpZCcsXG4gICAgICAgICdqc29uJyxcbiAgICAgICAgJ3ByZXZpb3VzU2libGluZ3NUb3RhbENvdW50JyxcbiAgICAgICAgJ3JlYWRPbmx5JyxcbiAgICAgICAgJ3JlbGF0aW9ucycsXG4gICAgICAgICdyZXNvdXJjZXMnLFxuICAgICAgICAncmVzb3VyY2VTdG9yZScsXG4gICAgICAgICdyZXNvdXJjZVRpbWVSYW5nZXMnLFxuICAgICAgICAncmVzb3VyY2VUaW1lUmFuZ2VTdG9yZScsXG4gICAgICAgICdzdG0nLFxuICAgICAgICAndGltZVJhbmdlcycsXG4gICAgICAgICd0aW1lUmFuZ2VTdG9yZScsXG4gICAgICAgICd0aW1lWm9uZScsXG4gICAgICAgICd2aXNpYmxlRGVzY2VuZGFudENvdW50J1xuICAgIF0pO1xuXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmO1xuICAgIHB1YmxpYyBpbnN0YW5jZSE6IFByb2plY3RNb2RlbDtcblxuICAgIHByaXZhdGUgYnJ5bnR1bUNvbmZpZyA9IHtcbiAgICAgICAgYWRvcHQgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgYXBwZW5kVG8gICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgaHJlZiAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgYW5ndWxhckNvbXBvbmVudCA6IHRoaXMsXG4gICAgICAgIGZlYXR1cmVzICAgICAgICAgOiB7fSxcbiAgICAgICAgbGlzdGVuZXJzICAgICAgICA6IHt9XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQ6IEVsZW1lbnRSZWYpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50UmVmID0gZWxlbWVudDtcbiAgICB9XG5cbiAgICAgLy8gQ29uZmlncyBvbmx5XG4gICAgQElucHV0KCkgYXNzaWdubWVudE1vZGVsQ2xhc3MgICAgICAgISA6IHR5cGVvZiBBc3NpZ25tZW50TW9kZWw7XG4gICAgQElucHV0KCkgYXNzaWdubWVudHNEYXRhICAgICAgICAgICAgISA6IEFzc2lnbm1lbnRNb2RlbFtdfFBhcnRpYWw8QXNzaWdubWVudE1vZGVsQ29uZmlnPltdO1xuICAgIEBJbnB1dCgpIGFzc2lnbm1lbnRTdG9yZUNsYXNzICAgICAgICEgOiB0eXBlb2YgQXNzaWdubWVudFN0b3JlO1xuICAgIEBJbnB1dCgpIGRlcGVuZGVuY2llc0RhdGEgICAgICAgICAgICEgOiBEZXBlbmRlbmN5TW9kZWxbXXxQYXJ0aWFsPERlcGVuZGVuY3lNb2RlbENvbmZpZz5bXTtcbiAgICBASW5wdXQoKSBkZXBlbmRlbmN5TW9kZWxDbGFzcyAgICAgICAhIDogdHlwZW9mIERlcGVuZGVuY3lNb2RlbDtcbiAgICBASW5wdXQoKSBkZXBlbmRlbmN5U3RvcmVDbGFzcyAgICAgICAhIDogdHlwZW9mIERlcGVuZGVuY3lTdG9yZTtcbiAgICBASW5wdXQoKSBldmVudE1vZGVsQ2xhc3MgICAgICAgICAgICAhIDogdHlwZW9mIEV2ZW50TW9kZWw7XG4gICAgQElucHV0KCkgZXZlbnRzRGF0YSAgICAgICAgICAgICAgICAgISA6IEV2ZW50TW9kZWxbXXxQYXJ0aWFsPEV2ZW50TW9kZWxDb25maWc+W107XG4gICAgQElucHV0KCkgZXZlbnRTdG9yZUNsYXNzICAgICAgICAgICAgISA6IHR5cGVvZiBFdmVudFN0b3JlO1xuICAgIEBJbnB1dCgpIGV4cGFuZGVkICAgICAgICAgICAgICAgICAgICEgOiBib29sZWFuO1xuICAgIEBJbnB1dCgpIG9yZGVyZWRQYXJlbnRJbmRleCAgICAgICAgICEgOiBudW1iZXI7XG4gICAgQElucHV0KCkgcGFyZW50SWQgICAgICAgICAgICAgICAgICAgISA6IHN0cmluZ3xudW1iZXJ8bnVsbDtcbiAgICBASW5wdXQoKSBwYXJlbnRJbmRleCAgICAgICAgICAgICAgICAhIDogbnVtYmVyO1xuICAgIEBJbnB1dCgpIHJlc291cmNlTW9kZWxDbGFzcyAgICAgICAgICEgOiB0eXBlb2YgUmVzb3VyY2VNb2RlbDtcbiAgICBASW5wdXQoKSByZXNvdXJjZXNEYXRhICAgICAgICAgICAgICAhIDogUmVzb3VyY2VNb2RlbFtdfFBhcnRpYWw8UmVzb3VyY2VNb2RlbENvbmZpZz5bXTtcbiAgICBASW5wdXQoKSByZXNvdXJjZVN0b3JlQ2xhc3MgICAgICAgICAhIDogdHlwZW9mIFJlc291cmNlU3RvcmU7XG4gICAgQElucHV0KCkgcmVzb3VyY2VUaW1lUmFuZ2VzRGF0YSAgICAgISA6IFJlc291cmNlVGltZVJhbmdlTW9kZWxbXTtcbiAgICBASW5wdXQoKSByZXNvdXJjZVRpbWVSYW5nZVN0b3JlQ2xhc3MhIDogdHlwZW9mIFJlc291cmNlVGltZVJhbmdlU3RvcmU7XG4gICAgQElucHV0KCkgc2lsZW5jZUluaXRpYWxDb21taXQgICAgICAgISA6IGJvb2xlYW47XG4gICAgQElucHV0KCkgdGltZVJhbmdlTW9kZWxDbGFzcyAgICAgICAgISA6IHR5cGVvZiBUaW1lUmFuZ2VNb2RlbDtcbiAgICBASW5wdXQoKSB0aW1lUmFuZ2VzRGF0YSAgICAgICAgICAgICAhIDogVGltZVNwYW5bXTtcbiAgICBASW5wdXQoKSB0aW1lUmFuZ2VTdG9yZUNsYXNzICAgICAgICAhIDogdHlwZW9mIFN0b3JlO1xuXG4gICAgIC8vIENvbmZpZ3MgYW5kIHByb3BlcnRpZXNcbiAgICBASW5wdXQoKSBhc3NpZ25tZW50cyAgICAgICAgICAgISA6IEFzc2lnbm1lbnRNb2RlbFtdfFBhcnRpYWw8QXNzaWdubWVudE1vZGVsQ29uZmlnPltdO1xuICAgIEBJbnB1dCgpIGFzc2lnbm1lbnRTdG9yZSAgICAgICAhIDogQXNzaWdubWVudFN0b3JlfFBhcnRpYWw8QXNzaWdubWVudFN0b3JlQ29uZmlnPjtcbiAgICBASW5wdXQoKSBjaGlsZHJlbiAgICAgICAgICAgICAgISA6IGJvb2xlYW58b2JqZWN0W118TW9kZWxbXXxQYXJ0aWFsPE1vZGVsQ29uZmlnPltdO1xuICAgIEBJbnB1dCgpIGRlcGVuZGVuY2llcyAgICAgICAgICAhIDogRGVwZW5kZW5jeU1vZGVsW118UGFydGlhbDxEZXBlbmRlbmN5TW9kZWxDb25maWc+W107XG4gICAgQElucHV0KCkgZGVwZW5kZW5jeVN0b3JlICAgICAgICEgOiBEZXBlbmRlbmN5U3RvcmV8UGFydGlhbDxEZXBlbmRlbmN5U3RvcmVDb25maWc+O1xuICAgIEBJbnB1dCgpIGV2ZW50cyAgICAgICAgICAgICAgICAhIDogRXZlbnRNb2RlbFtdfFBhcnRpYWw8RXZlbnRNb2RlbENvbmZpZz5bXTtcbiAgICBASW5wdXQoKSBldmVudFN0b3JlICAgICAgICAgICAgISA6IEV2ZW50U3RvcmV8UGFydGlhbDxFdmVudFN0b3JlQ29uZmlnPjtcbiAgICBASW5wdXQoKSBpZCAgICAgICAgICAgICAgICAgICAgISA6IHN0cmluZ3xudW1iZXI7XG4gICAgQElucHV0KCkganNvbiAgICAgICAgICAgICAgICAgICEgOiBzdHJpbmc7XG4gICAgQElucHV0KCkgcmVhZE9ubHkgICAgICAgICAgICAgICEgOiBib29sZWFuO1xuICAgIEBJbnB1dCgpIHJlc291cmNlcyAgICAgICAgICAgICAhIDogUmVzb3VyY2VNb2RlbFtdfFBhcnRpYWw8UmVzb3VyY2VNb2RlbENvbmZpZz5bXTtcbiAgICBASW5wdXQoKSByZXNvdXJjZVN0b3JlICAgICAgICAgISA6IFJlc291cmNlU3RvcmV8UGFydGlhbDxSZXNvdXJjZVN0b3JlQ29uZmlnPjtcbiAgICBASW5wdXQoKSByZXNvdXJjZVRpbWVSYW5nZXMgICAgISA6IFJlc291cmNlVGltZVJhbmdlTW9kZWxbXXxQYXJ0aWFsPFJlc291cmNlVGltZVJhbmdlTW9kZWxDb25maWc+W107XG4gICAgQElucHV0KCkgcmVzb3VyY2VUaW1lUmFuZ2VTdG9yZSEgOiBSZXNvdXJjZVRpbWVSYW5nZVN0b3JlfFBhcnRpYWw8UmVzb3VyY2VUaW1lUmFuZ2VTdG9yZUNvbmZpZz47XG4gICAgQElucHV0KCkgc3RtICAgICAgICAgICAgICAgICAgICEgOiBTdGF0ZVRyYWNraW5nTWFuYWdlcnxQYXJ0aWFsPFN0YXRlVHJhY2tpbmdNYW5hZ2VyQ29uZmlnPjtcbiAgICBASW5wdXQoKSB0aW1lUmFuZ2VzICAgICAgICAgICAgISA6IFRpbWVTcGFuW118UGFydGlhbDxUaW1lU3BhbkNvbmZpZz5bXTtcbiAgICBASW5wdXQoKSB0aW1lUmFuZ2VTdG9yZSAgICAgICAgISA6IFN0b3JlfFBhcnRpYWw8U3RvcmVDb25maWc+O1xuICAgIEBJbnB1dCgpIHRpbWVab25lICAgICAgICAgICAgICAhIDogc3RyaW5nfG51bWJlcjtcblxuICAgICAvLyBQcm9wZXJ0aWVzIG9ubHlcbiAgICBASW5wdXQoKSBhbGxDaGlsZHJlbiAgICAgICAgICAgICAgICEgOiBNb2RlbFtdO1xuICAgIEBJbnB1dCgpIGF1dG9FeHBvc2VGaWVsZHMgICAgICAgICAgISA6IGJvb2xlYW47XG4gICAgQElucHV0KCkgY2hpbGRyZW5GaWVsZCAgICAgICAgICAgICAhIDogc3RyaW5nO1xuICAgIEBJbnB1dCgpIGNvbnZlcnRFbXB0eVBhcmVudFRvTGVhZiAgISA6IGJvb2xlYW58b2JqZWN0O1xuICAgIEBJbnB1dCgpIGRlZmF1bHRzICAgICAgICAgICAgICAgICAgISA6IG9iamVjdDtcbiAgICBASW5wdXQoKSBkZXNjZW5kYW50Q291bnQgICAgICAgICAgICEgOiBudW1iZXI7XG4gICAgQElucHV0KCkgaGFzR2VuZXJhdGVkSWQgICAgICAgICAgICAhIDogYm9vbGVhbjtcbiAgICBASW5wdXQoKSBpZEZpZWxkICAgICAgICAgICAgICAgICAgICEgOiBzdHJpbmc7XG4gICAgQElucHV0KCkgaW5saW5lRGF0YSAgICAgICAgICAgICAgICAhIDogb2JqZWN0O1xuICAgIEBJbnB1dCgpIGludGVybmFsSWQgICAgICAgICAgICAgICAgISA6IG51bWJlcjtcbiAgICBASW5wdXQoKSBpc0NvbW1pdHRpbmcgICAgICAgICAgICAgICEgOiBib29sZWFuO1xuICAgIEBJbnB1dCgpIGlzQ3JlYXRpbmcgICAgICAgICAgICAgICAgISA6IGJvb2xlYW47XG4gICAgQElucHV0KCkgaXNWYWxpZCAgICAgICAgICAgICAgICAgICAhIDogYm9vbGVhbjtcbiAgICBASW5wdXQoKSBwcmV2aW91c1NpYmxpbmdzVG90YWxDb3VudCEgOiBudW1iZXI7XG4gICAgQElucHV0KCkgcmVsYXRpb25zICAgICAgICAgICAgICAgICAhIDogUmVjb3JkPHN0cmluZywgUmVsYXRpb25Db25maWc+O1xuICAgIEBJbnB1dCgpIHZpc2libGVEZXNjZW5kYW50Q291bnQgICAgISA6IG51bWJlcjtcblxuICAgICAvLyBFdmVudHNcbiAgICBAT3V0cHV0KCkgb25DaGFuZ2UgICAgPSBuZXcgRXZlbnRFbWl0dGVyPG9iamVjdD4oKTtcbiAgICBAT3V0cHV0KCkgb25EYXRhUmVhZHkgPSBuZXcgRXZlbnRFbWl0dGVyPG9iamVjdD4oKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhbmQgYXBwZW5kIHRoZSB1bmRlcmx5aW5nIHdpZGdldFxuICAgICAqL1xuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICBjb25zdFxuICAgICAgICAgICAgbWUgPSB0aGlzLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGVsZW1lbnRSZWYsXG4gICAgICAgICAgICAgICAgYnJ5bnR1bUNvbmZpZ1xuICAgICAgICAgICAgfSA9IG1lLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlQ2xhc3MsXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VOYW1lLFxuICAgICAgICAgICAgICAgIGJyeW50dW1Db25maWdzLFxuICAgICAgICAgICAgICAgIGJyeW50dW1FdmVudHNcbiAgICAgICAgICAgIH0gPSBCcnludHVtUHJvamVjdE1vZGVsQ29tcG9uZW50O1xuXG4gICAgICAgIGJyeW50dW1Db25maWdzLmZpbHRlcihwcm9wID0+IHByb3AgaW4gdGhpcykuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIFdyYXBwZXJIZWxwZXIuYXBwbHlQcm9wVmFsdWUoYnJ5bnR1bUNvbmZpZywgcHJvcCwgdGhpc1twcm9wXSk7XG4gICAgICAgICAgICBpZiAoWydmZWF0dXJlcycsICdjb25maWcnXS5pbmNsdWRlcyhwcm9wKSkge1xuICAgICAgICAgICAgICAgIFdyYXBwZXJIZWxwZXIuZGV2V2FybmluZ0NvbmZpZ1Byb3AoaW5zdGFuY2VOYW1lLCBwcm9wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgYnJ5bnR1bUV2ZW50cy5maWx0ZXIoZXZlbnQgPT4gdGhpc1tldmVudF0gJiYgdGhpc1tldmVudF0ub2JzZXJ2ZXJzLmxlbmd0aCA+IDApLmZvckVhY2goZXZlbnQgPT4ge1xuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICB1bmNhcGl0YWxpemUgPSAoc3RyOiBzdHJpbmcpID0+IHN0ci5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHN0ci5zbGljZSgxKSxcbiAgICAgICAgICAgICAgICBldmVudE5hbWUgPSAoc3RyOiBzdHJpbmcpID0+IHVuY2FwaXRhbGl6ZShzdHIuc2xpY2UoMikpO1xuXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBicnludHVtQ29uZmlnLmxpc3RlbmVyc1tldmVudE5hbWUoZXZlbnQpXSA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICBtZVtldmVudF0uZW1pdChlKTtcbiAgICAgICAgICAgICAgICAvLyBFdmVudEVtaXR0ZXIgZG9lcyBub3QgcmV0dXJuIHZhbHVlcyBpbiB0aGUgbm9ybWFsIHdheSwgd29yayBhcm91bmQgaXQgYnkgc2V0dGluZyBgcmV0dXJuVmFsdWVgIGZsYWdcbiAgICAgICAgICAgICAgICAvLyBpbiBBbmd1bGFyIGxpc3RlbmVyc1xuICAgICAgICAgICAgICAgIHJldHVybiBlLnJldHVyblZhbHVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSWYgY29tcG9uZW50IGhhcyBubyBjb250YWluZXIgc3BlY2lmaWVkIGluIGNvbmZpZyB0aGVuIHVzZSBhZG9wdCB0byBXcmFwcGVyJ3MgZWxlbWVudFxuICAgICAgICBjb25zdFxuICAgICAgICAgICAgY29udGFpbmVyUGFyYW0gPSBbXG4gICAgICAgICAgICAgICAgJ2Fkb3B0JyxcbiAgICAgICAgICAgICAgICAnYXBwZW5kVG8nLFxuICAgICAgICAgICAgICAgICdpbnNlcnRBZnRlcicsXG4gICAgICAgICAgICAgICAgJ2luc2VydEJlZm9yZSdcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBdLmZpbmQocHJvcCA9PiBicnludHVtQ29uZmlnW3Byb3BdKTtcbiAgICAgICAgaWYgKCFjb250YWluZXJQYXJhbSkge1xuICAgICAgICAgICAgaWYgKGluc3RhbmNlTmFtZSA9PT0gJ0J1dHRvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBCdXR0b24gc2hvdWxkIGFsd2F5cyBiZSA8YT4gb3IgPGJ1dHRvbj4gaW5zaWRlIG93bmVyIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBicnludHVtQ29uZmlnLmFwcGVuZFRvID0gZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJ5bnR1bUNvbmZpZy5hZG9wdCA9IGVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIFdyYXBwZXJIZWxwZXIuZGV2V2FybmluZ0NvbnRhaW5lcihpbnN0YW5jZU5hbWUsIGNvbnRhaW5lclBhcmFtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgbWUuaW5zdGFuY2UgPSBpbnN0YW5jZU5hbWUgPT09ICdXaWRnZXQnID8gV2lkZ2V0SGVscGVyLmNyZWF0ZVdpZGdldChicnludHVtQ29uZmlnKSA6IG5ldyBpbnN0YW5jZUNsYXNzKGJyeW50dW1Db25maWcpO1xuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2F0Y2ggZm9yIGNoYW5nZXNcbiAgICAgKiBAcGFyYW0gY2hhbmdlc1xuICAgICAqL1xuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3RcbiAgICAgICAgICAgIHsgaW5zdGFuY2UgfSA9IHRoaXMsXG4gICAgICAgICAgICB7IGluc3RhbmNlTmFtZSB9ID0gQnJ5bnR1bVByb2plY3RNb2RlbENvbXBvbmVudDtcbiAgICAgICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIEl0ZXJhdGUgb3ZlciBhbGwgY2hhbmdlc1xuICAgICAgICBPYmplY3QuZW50cmllcyhjaGFuZ2VzKS5mb3JFYWNoKChbcHJvcCwgY2hhbmdlXSkgPT4ge1xuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IChjaGFuZ2UgYXMgU2ltcGxlQ2hhbmdlKS5jdXJyZW50VmFsdWUsXG4gICAgICAgICAgICAgICAgeyBpbnN0YW5jZSB9ID0gdGhpcyxcbiAgICAgICAgICAgICAgICB7IGJyeW50dW1Db25maWdzT25seSwgYnJ5bnR1bVByb3BzIH0gPSBCcnludHVtUHJvamVjdE1vZGVsQ29tcG9uZW50O1xuICAgICAgICAgICAgaWYgKGJyeW50dW1Qcm9wcy5pbmNsdWRlcyhwcm9wKSkge1xuICAgICAgICAgICAgICAgIFdyYXBwZXJIZWxwZXIuYXBwbHlQcm9wVmFsdWUoaW5zdGFuY2UsIHByb3AsIG5ld1ZhbHVlLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKGJyeW50dW1Db25maWdzT25seS5pbmNsdWRlcyhwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICBXcmFwcGVySGVscGVyLmRldldhcm5pbmdVcGRhdGVQcm9wKGluc3RhbmNlTmFtZSwgcHJvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95IHRoZSBjb21wb25lbnRcbiAgICAgKi9cbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLmluc3RhbmNlICYmIHRoaXMuaW5zdGFuY2UuZGVzdHJveSAmJiB0aGlzLmluc3RhbmNlLmRlc3Ryb3koKTtcbiAgICB9XG59XG4iXX0=